#!/bin/bash

# Base
. ${0%/*}/../res/base/sensei.base

DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
$DIR/sensei-db-command "SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED; SELECT s.SensorName, s.Measure,s.Unit,s.Value,s.DateField FROM sensors_values AS s INNER JOIN (SELECT SensorName, Measure,Unit,MAX(DateField) AS DateField FROM (SELECT * FROM sensors_values WHERE DateField >( (NOW() - INTERVAL $SENSEI_DB_VALUE_INTERVAL SECOND)+0)) AS t GROUP BY SensorName,Measure,Unit) AS sl ON s.SensorName = sl.SensorName AND s.Measure=sl.Measure AND s.Unit=sl.Unit AND s.DateField=sl.DateField" $1 $2
